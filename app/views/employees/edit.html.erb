<h1> Edit Employee <%= @employee.name %> </h1>

<%= error_messages_for :employee %>
<h2> Change Name and Notes </h2>
<%= form_for @employee do |form| %>
	<p>
		<%= form.label :name %>
		<%= form.text_field :name %>
	</p>
	<p>
		<%= form.label :notes %>
		<%= form.text_field :notes %>
	</p>
	<p><%= form.submit  "Save changes" %></p>
<% end %>


<!-- Drop-down list of services that can be added. Only populated with services that the employee doesn't already have. -->
<h2> Add Services </h2>
<%= form_tag("add_service", :method => "post") do %>
<%= error_messages_for :employee_allocation %>
	<p>
		<%= label_tag :name %>
		<%= collection_select(:employee_allocation, :service_id, @employee.get_available_services, :id, :name) %>
		<%= select(:employee_allocation, :allocation, [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1]) %>
		<%= submit_tag  "Add" %>
	</p>
<% end %>



<!-- Creates table with the employee's services and allocations -->
<table><caption> Existing Services</caption>
	<thead>
		<th>Services</th>
		<th>Allocations</th>
	</thead>
	<tbody>
		<% @employee.employee_allocations.each do |employee_allocation| %>
			<% if employee_allocation != @employee_allocation %>
			<tr>
				<td> <%= employee_allocation.service.name %> </td>
		  	<td> <%= employee_allocation.allocation %> </td>
				<td> 
					<%= form_tag("remove_service", :method => "post") do %>
						<%= hidden_field_tag(:employee_allocation, employee_allocation.id) %>
						<%= submit_tag  "Remove", :confirm => "Confirm removal." %>
					<% end %>
				</td>
			</tr>
			<% end %>
		<% end %>
	</tbody>
</table>


<%= link_to "Back", employees_path %>