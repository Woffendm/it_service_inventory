<h2> 
  <%= t(:edit) + t(:group_colon) %> <%= @group.name %> 
  <%= link_to "#{content_tag :em, '', :class => ''}
            #{t(:show)}".html_safe, group_path(@group.id) %>
</h2>


<%= form_for @group do |group_form| %>


  <ul class="nav nav-tabs" id="my-tab">
    <li class="active">
      <a href="#employees" id="employees_tab" data-toggle="tab" > 
        <%= t(:employees) %>
      </a>
    </li>
    <li>
      <a href="#portfolios" id="portfolios_tab" data-toggle="tab"> 
        <%= t(:portfolios) %> 
      </a>
    </li>
    <li>
      <a href="#group" id="group_tab" data-toggle="tab"> 
        <%= t(:group) + t(:information) %> 
      </a>
    </li>
  </ul>
  
  
  <div class="tab-content">
      
    <div class="tab-pane" id="group"> 
      <div class="form-inline light-border">
        <%= fields_for @group do |form| %>
          <%= form.label :name, t(:name) %>
          <%= form.text_field :name %>
        <% end %>
      </div>
    </div>
  
  
  
  
  
  
    <div class="tab-pane" id="portfolios">
      <div class="form-inline">
        <fieldset class="light-border">
          <legend><%= t(:add) + t(:portfolio) %></legend>
          <%= fields_for "portfolio" do |form|%>
            <%= form.label :portfolio, t(:name) %>
            <%= form.text_field :name %>
            <%= form.submit t(:add) %>
          <% end %>
        </fieldset>
      </div>
      
      
      <h3> <%= t(:existing_portfolios) %> </h3>
      <% if @portfolios.blank? %>
        <p>
          <%= t(:nothing_to_display) %>
        </p>
      <% else %>
        <div class="accordion" id="accordion">
          <% @portfolios.each_with_index do |portfolio, index| %>
            <% next if portfolio.products.blank? %>
            <div class="accordion-group">
              <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse"
                    data-target="#collapse-<%=index%>"  href="#">
                  <span class="accordion-title">
                    <%= portfolio.name %>
                  </span>
                  <span class="accordion-detail"> 
                    <%= "#{portfolio.products.length} " + t(:products) %> 
                  </span>
                </a>
              </div>
              <div id="collapse-<%=index%>" class="accordion-body collapse">
                <div class="accordion-inner">
                  <% unless portfolio.products.blank? %>
                    <table class="table table-striped">
                      <thead>
                        <tr>
                          <th> <%= t(:product) %> </th>
                          <th class='variable-size'> <%= t(:priority) %> </th>
                          <th> <%= t(:product_state) %> </th>
                          <th> <%= t(:product_type) %> </th>
                          <th> <%= t(:allocation) %> </th>
                        </tr>
                      </thead>
                      <tbody>
                        <% portfolio.products.each_with_index do |product, index| %>
                          <tr>
                            <td> 
                              <%= link_to product.name, product_path(product.id) %>
                            </td>
                            <td class='variable-size'> 
                              <%= product.priority %>
                            </td>
                            <td > 
                              <%= product.state %>
                            </td>
                            <td> 
                              <%= product.type %>
                            </td>
                            <td>
                    
                            </td>
                          </tr>
                        <% end %>
                      </tbody>
                    </table>
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>      
        </div>
      <% end %>
    </div>
  
  
  
  
  
  
    <div class="tab-pane active" id="employees">
      <% unless @possible_employees.blank? %>
        <div class="form-inline">
          <fieldset class="light-border">
            <legend><%= t(:add) + t(:employee) %></legend>
            <%= fields_for "employee_group" do |form|%>
              <%= form.label :employee_id, t(:name) %>
              <%= form.select(:employee_id, options_from_collection_for_select(
                              @possible_employees, :id, :full_name),
                              {:include_blank => "-" + t(:select) + t(:employee) + "-", 
                              :class => "autocomplete large-select"}) %>
              <%= form.submit  t(:add) %>
            <% end %>
          </fieldset>
        </div>
      <% end %>
      
      
      <% unless @existing_employees.blank? %>
        <table class="table table-striped">
          <caption> 
            <%= t(:existing_employees) %> 
          </caption> 
          <thead>
            <tr>
              <th> 
                <%= t(:name) %>
              </th>
              <th> 
                <%= t(:group_admin) %>
              </th>
              <th> 
                <%= t(:check_to_remove) %>
              </th>
            </tr>
          </thead>
          <tbody>
            <% @existing_employees.each do |employee_group| %>
              <%= group_form.fields_for "employee_groups", employee_group do |form|%>
                <tr>
                  <td>
                    <%= link_to employee_group.employee.full_name,
                        employee_path(employee_group.employee_id) %>
                  </td>
                  <td>
                    <%= form.hidden_field(:employee_id, :value => employee_group.employee_id) %>
                    <%= form.hidden_field(:id, :value => employee_group.id) %>
                    <%= form.check_box :group_admin, :value => employee_group.group_admin %>
                  </td>
                  <td>
                    <%= form.check_box :_destroy %>
                  </td>
                </tr>
              <% end %>
            <% end %>
          </tbody>
        </table>
        <div class="pagination_footer">
          <%= will_paginate @existing_employees, :param_name => :employees_page %>
          <%= render :partial => "/shared/results_per_page" %>
        </div>
      <% end %>
    </div>
  </div>
  <%= group_form.submit  t(:save_changes) %> 
  
  
  
<% end %>