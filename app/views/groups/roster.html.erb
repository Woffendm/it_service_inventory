<h2> <%= t(:employee_roster_for_group) + @group.name %> </h2>


<% if (@group.get_available_employees.length > 0)  && (can? :update, @group) %>
  <div class="form-inline">
    <fieldset class="light-border">
      <legend><%= t(:add) + t(:employee) %></legend>
      <%= form_tag( "add_employee", :method => "post") do %>
        <%= label_tag :employee_id, t(:name) %>
        <%= collection_select(:employee, :id, @group.get_available_employees, :id, :full_name,
                             {:include_blank => true}, {:class => "autocomplete large-select", 
                             "data-placeholder" => "Choose an employee"}) %>
        <%= submit_tag  t(:add) %>
      <% end %>
    </fieldset>
  </div>
<% end %>


<% if @paginated_employees.any? %>
  <table class="table table-striped"><caption> <%= t(:existing_employees) %> </caption>
    <tbody>
      <% @paginated_employees.each do |employee| %>
        <tr>
          <td>
            <%= render  :partial => "/shared/can_update_employee", 
                        :locals => {:@employee => employee} %>
          </td>
          <td>
              <% if can? :update, @group %>
                <%= form_tag("toggle_group_admin", :method => "post", 
                            :class => "prevent_double_submit") do %>
                  <%= hidden_field_tag(:employee, employee.id) %>
                  <% if @group.employee_groups.find_by_employee_id(employee.id).group_admin &&
                        ((employee != @current_user) || @current_user.site_admin )%>
                    <%= submit_tag  t(:remove) + t(:group_admin), :confirm => t(:confirm_removal) %>
                  <% else %>
                    <%= submit_tag  t(:make) + t(:group_admin), :confirm => t(:confirm_admin) %>
                  <% end %>
                <% end %>
              <% end %>
          </td>
          <td>
            <% if can? :update, @group %>
              <%= form_tag("remove_employee", :method => "post") do %>
                <%= hidden_field_tag(:employee, employee.id) %>
                <%= submit_tag  t(:remove), :confirm => t(:confirm_removal) %>
              <% end %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
  <div class="pagination_footer">
    <%= will_paginate @paginated_employees %>
    <%= render :partial => "/shared/results_per_page" %>
  </div>
<% end %>


<br/><br/><br/>
<%= link_to t(:return_to) + t(:all_groups), groups_path %>