<h2> Employee Roster for Group: <%= @group.name %> </h2>


<% if (@group.get_available_employees.length > 0)  && (can? :update, @group) %>
	<h3>Add Employee</h3>
	<div id="my-form">
		<%= form_tag("add_employee", :method => "post") do %>
			<p>
				<%= label_tag :name %>
				<%= collection_select(:employee, :id, @group.get_available_employees, :id, :full_name) %>
				<%= submit_tag  "Add" %>
			</p>
		<% end %>
	</div>
<% end %>


<% if @group.employees.any? %>
	<table class="list issues"><caption> Existing Employees </caption>
		<thead>
			<th> </th>
			<th>  </th>
		</thead>
		<tbody>
			<% @group.employees.order(:name_last).each do |employee| %>
				<% if @odd %>
					<% @odd = false %>
					<tr class="even">
				<% else %>
					<% @odd = true %>
					<tr class="odd">
				<% end %>
					<td>
						<% if can? :update, employee %>
							<%= link_to employee.full_name , edit_employee_path(employee.id) %> 
						<% else %>
							<%= employee.full_name %>
						<% end %>
					</td>
					<td>
						<% if @group.employee_groups.find_by_employee_id(employee.id).group_admin %>
							Group Admin
						<% else %>
							<% if can? :update, @group %>
								<%= form_tag("add_group_admin", :method => "post") do %>
					 				<%= hidden_field_tag(:employee, employee.id) %>
					 				<%= submit_tag  "Make Group Admin", :confirm => 
																	"This will allow the selected employee to edit everything" + 					
																	" within this group. Are you sure?" %>
					 			<% end %>
							<% end %>
						<% end %>
					</td>
					<% if can? :update, @group %>
						<td>
							<%= form_tag("remove_employee", :method => "post") do %>
								<%= hidden_field_tag(:employee, employee.id) %>
								<%= submit_tag  "Remove", :confirm => "Confirm removal." %>
							<% end %>
						</td>
					<% end %>
				</tr>
			<% end %>
		</tbody>
	</table>
<% end %>

<br/><br/>
<%= link_to "Return to All Groups", groups_path %>